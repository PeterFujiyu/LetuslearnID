# letuslearn.now 统一账号系统

本文档规划了在 **letuslearn.now** 域名下构建统一账号系统的总体思路。该系统将允许用户只使用一个账号即可访问所有子服务，其中文件存储服务 [Cloudreve](https://cloud.letuslearn.now) 已经部署完成。

## 技术栈

1. **后端框架**：采用 **Node.js** 搭配 **Express**，以获得轻量而灵活的服务端实现。
2. **数据库**：使用 **PostgreSQL**，可在轻量开发阶段先使用 SQLite，后续快速转向 PostgreSQL。
3. **身份验证**：基于 **JWT**（JSON Web Token）实现无状态认证，如有需要可扩展支持 OAuth 2.0。
4. **反向代理**：通过 **Nginx** 进行 HTTPS 终端处理及后端服务转发。
5. **前端**：使用 **React** 构建现代化的用户界面。

## 核心功能

1. **单点登录（SSO）**：用户只需注册和登录一次即可访问所有子域，包括 Cloudreve 及未来的新服务。
2. **统一用户数据库**：所有用户信息集中存储在 PostgreSQL 中，并提供 API 处理注册、登录、资料管理和权限等操作。
3. **令牌认证**：登录成功后颁发 JWT，子域通过请求头或 Cookie 验证令牌，完成跨服务的统一鉴权。
4. **角色管理**：实现多角色（如管理员、普通用户）机制，按角色控制不同服务的访问级别。
5. **Cloudreve 集成**：通过 API 回调或类似 OAuth 的插件，将 Cloudreve 的登录验证交由统一账号系统处理。

## 部署考虑

- **Docker**：利用 Docker 打包 Node.js 服务、数据库以及其他依赖，实现一致的部署环境。
- **HTTPS**：使用如 Let’s Encrypt 的 TLS 证书，保证通信安全。
- **可扩展性**：API 设计采用模块化路由，便于未来新增服务。
- **监控与日志**：使用 **Winston** 等日志工具及 **Prometheus** 之类的监控方案，跟踪系统状态。

## 后续步骤

1. 建立 Git 仓库结构，按 server、client 与部署脚本等目录分开管理。
2. 初始化 Express 服务并连接 SQLite，未来可以迁移至 PostgreSQL。
4. 实现基础的注册与登录接口。
5. 配置 Cloudreve，使其通过该统一认证机制完成登录验证。
6. 提供账户设置页，可在其中修改登录密码。
